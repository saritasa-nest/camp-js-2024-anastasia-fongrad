import{r as l,j as o,B as x,T as h,e as y,s as j,f as b,a2 as v,aa as E,ab as L,ac as N,ad as S,N as k}from"./index-DKRBk0iP.js";import{z as p,u as w,C as f,T as F,P,t as T,E as B,L as C}from"./PasswordField-DDCftXz8.js";import{B as A}from"./Button-DgXjCY_O.js";import"./OutlinedInput-Dj5Noa6t.js";import"./Select-Bb6cyZCW.js";const q="_form_knxh3_1",D="_form__control_knxh3_5",$="_form__error_knxh3_10",I="_form__button_knxh3_14",i={form:q,form__control:D,form__error:$,form__button:I},g=p.object({email:p.string().min(1,{message:"Email is required"}),password:p.string().min(1,{message:"Password is required"})}),R={email:"",password:""};function U(r){return r in g.shape}const V=({onSubmit:r,serverErrors:s})=>{var m,c;const{handleSubmit:u,formState:{errors:t},control:a,setError:_}=w({defaultValues:R,resolver:T(g)});return l.useEffect(()=>{s.forEach(e=>{U(e.controlName)&&_(e.controlName,{type:"manual",message:e.controlErrors[0]})})},[s]),o.jsxs(x,{component:"form",onSubmit:u(r),className:i.form,children:[o.jsx(f,{name:"email",control:a,render:({field:e})=>{var n;return o.jsx(F,{...e,label:"Email",InputLabelProps:{required:!0},fullWidth:!0,error:t.email!=null,helperText:(n=t==null?void 0:t.email)==null?void 0:n.message,className:i.form__control})}}),o.jsx(f,{name:"password",control:a,render:({field:e})=>{var n;return o.jsx(P,{field:e,hasError:t.password!=null,errorMessage:(n=t==null?void 0:t.password)==null?void 0:n.message,label:"Password"})}}),o.jsx(h,{component:"p",gutterBottom:!0,className:i.form__error,children:((m=s[0])==null?void 0:m.controlName)==="form"&&((c=s[0])==null?void 0:c.controlErrors[0])}),o.jsx(A,{type:"submit",fullWidth:!0,variant:"contained",className:i.form__button,children:"Login"})]})},W=l.memo(V),z="_layout_covh8_1",M="_layout_open_covh8_12",O="_layout__card_covh8_17",d={layout:z,layout_open:M,layout__card:O},G=()=>{const r=y(j),[s,u]=l.useState([]),t="/registration",a=b(),_=v(),m=l.useCallback(c=>{E.login(c).then(e=>{L.saveAuthToken(e),a(N()),_("/anime")}).catch(e=>u(B.parseError(e)))},[a]);return o.jsx("main",{className:`${d.layout} ${r?d.layout_open:""}`,children:o.jsxs(S,{elevation:3,className:d.layout__card,children:[o.jsx(h,{variant:"h5",component:"h5",children:"Login"}),o.jsx(W,{onSubmit:m,serverErrors:s}),o.jsxs(h,{component:"p",children:["Don't have an account?",o.jsx(C,{component:k,to:t,children:"Register"})]})]})})},Y=l.memo(G);export{Y as LoginPage};
